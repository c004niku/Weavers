@using GridMvc.Html
@model NewsModel
@{
    ViewBag.Title = "News";
    ViewBag.Header = "News for Weaver app";
    ViewBag.OptionalDescription = "All news for app";
}
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>
<script src="~/Scripts/ckeditor/ckeditor.js"></script>
<div class="card card-lime">
    <div class="card-header">
        <h3 class="card-title">News List</h3>

        <div class="card-tools">
            <button type="button" class="btn btn-tool" data-card-widget="collapse">
                <i class="fas fa-minus"></i>
            </button>
        </div>
        <!-- /.card-tools -->
    </div>
    <!-- /.card-header -->
    <div class="card-body">
        <div class="col-sm-5 text-right">
            <button type="button" class="btn btn-secondary btn-block btn-flat btn-primary additem" onclick="addNewValue('News')">Add News</button>
        </div>
        @Html.Grid(Model.Reports).Columns(columns =>
   {
       columns.Add().Encoded(false)
      .Sanitized(false)
      .SetWidth(80)
      .RenderValueAs(o => string.Format("<img src='http://{1}/UploadFiles/RepotItem/{0}' height='50px' width='80px'", o.Images.FirstOrDefault(), TempData["WebsiteName"]));
       columns.Add(c => c.Title).Titled("Title").Filterable(false);
       columns.Add(c => c.CreatedOn).Titled("Date").Filterable(false);
       columns.Add(c => c.Range).Titled("Range").Filterable(false);
       /*columns.Add().Encoded(false)
       .Sanitized(false)
       .SetWidth(30)
       .RenderValueAs(o => Html.ActionLink(linkText: "Delete", actionName: "Delete", controllerName: "News", routeValues: new { id = o.Id }, htmlAttributes: null));*/
       columns.Add().Encoded(false)
      .Sanitized(false)
      .SetWidth(30)
      .RenderValueAs(o => Html.AnchorLink("viewnews", "View", string.Format("newstitle='{0}' newsurl='{1}' newsdescription='{2}'", o.Title, o.Url, o.ShortDescription)));

       ;

   }).WithPaging(5).Sortable(true)
    </div>
</div>

<div class="modal fade" id="addItem" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title">Add</h4>
                <button type="button" onclick="ClearInput()" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
            </div>
            @using (Html.BeginForm("Save", "News", FormMethod.Post, new { enctype = "multipart/form-data" }))
            {
                <div class="modal-body">
                    <div class="form-group has-feedback">
                        <input class="form-control" id="newsTitle" name="newsTitle" placeholder="Please Enter News Title" type="text">
                    </div>
                    <div class="form-group has-feedback">
                        <input class="form-control" id="newsUrl" name="newsUrl" placeholder="Please Enter News URL" type="text">
                    </div>

                    <div class="form-group has-feedback">
                        <textarea class="form-control ckeditor" id="newsDescription"  name="newsDescription" rows="4" cols="50">
                </textarea>

                    </div>
                    <div class="form-group has-feedback">
                        @Html.TextBox("file", "Upload Image", new { type = "file" })
                    </div>
                    <div class="form-group has-feedback">
                        <select id="newsRange" name="newsRange">
                            <option value="Local">Local</option>
                            <option value="State">State</option>
                            <option value="National">National</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer justify-content-between">
                    <button type="button" class="btn btn-default" onclick="ClearInput()" data-dismiss="modal">Close</button>
                    <button type="submit" class="btn btn-primary bntSave">Save</button>
                </div>
            }
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>



<div class="modal fade" id="viewitem" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" onclick="ClearInput()" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">×</span>
                </button>
                <h4 class="modal-title"></h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-xs-3">
                        Title
                    </div>
                    <div class="col-xs-9">
                        <input class="form-control" id="viewnewsTitle" disabled type="text">
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">
                        Description
                    </div>
                    <div class="col-xs-9">
                        
                        <textarea class="form-control ckeditor" id="viewnewsDescription" name="viewnewsDescription" rows="4" cols="50">
                         </textarea>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-3">
                        Url
                    </div>
                    <div class="col-xs-9">
                        <input class="form-control" id="viewnewsUrl" disabled type="text">
                    </div>
                </div>
            </div>
            <div class="modal-footer justify-content-between">
                <button type="button" class="btn btn-default" onclick="ClearInput()" data-dismiss="modal">Close</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>

<script>
    $(document).ready(function () {

        $(".viewnews").click(function (event) {
            // event.preventDefault(); // cancel default behavior
            $('#viewnewsTitle').val('');
            $('#viewnewsDescription').html('');
            $('#viewnewsUrl').val('');

            var newsTitle = $(this).attr('newstitle');
            $('#viewnewsTitle').val(newsTitle);
            $('#viewnewsDescription').html($(this).attr('newsdescription'));
            $('#viewnewsUrl').val($(this).attr('newsurl'));
            $('.modal-title').html('View ' + newsTitle + ' detail');
            $('#viewitem').modal('show');
            //... rest of add logic
        });
    });

    function ClearInput() {
        $("#codevalue").val('');
        $("#codetype").val('');
    }
    function addNewValue(val) {
        $('#codetype').val(val);
        $('.modal-title').html('Add New ' + val);
        $('#codevaluelabel').html(val);
        $('#addItem').modal('show');
    }
    function ViewNewsValue(val) {
        $('#codetype').val(val);
        $('.modal-title').html(val);
        $('#codevaluelabel').html(val);
        $('#viewitem').modal('show');
       
        
    }
</script>

